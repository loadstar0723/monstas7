'use client'

import { useState } from 'react'
import Link from 'next/link'
import { usePathname } from 'next/navigation'
import { 
  FaHome, FaChartLine, FaRobot, FaBriefcase, FaHistory,
  FaTelegram, FaUsers, FaGraduationCap, FaNewspaper,
  FaUser, FaCog, FaBars, FaTimes, FaGlobe, FaChartPie,
  FaBrain, FaRocket, FaShieldAlt, FaWallet, FaGamepad,
  FaBook, FaUserTie, FaHandshake, FaStore, FaChartBar,
  FaCoins, FaExchangeAlt, FaMicrochip, FaLock, FaCrown,
  FaDna, FaAtom, FaFlask, FaLightbulb, FaNetworkWired,
  FaDatabase, FaServer, FaCloud, FaFingerprint, FaMagic,
  FaGem, FaDollarSign, FaBitcoin, FaEthereum, FaChartArea,
  FaBalanceScale, FaTrophy, FaMedal, FaAward, FaStar, FaKey,
  FaSignal, FaWaveSquare, FaSearch, FaVolumeUp, FaChessQueen,
  FaWater, FaEye, FaFire, FaSkull, FaBolt, FaRadiation,
  FaExclamationTriangle, FaUniversity, FaPiggyBank, FaMoneyBillWave,
  FaPercentage, FaCalculator, FaRing, FaSpaceShuttle, FaSatelliteDish,
  FaBroadcastTower, FaWifi, FaProjectDiagram, FaCodeBranch,
  FaLayerGroup, FaCubes, FaThLarge, FaStream, FaInfinity,
  FaChessKnight, FaBinoculars, FaCompass, FaAnchor, FaFlag,
  FaBullseye, FaCrosshairs, FaDice, FaChess, FaPuzzlePiece,
  FaTheaterMasks, FaTicketAlt, FaGift, FaBell, FaEnvelope,
  FaPaperPlane, FaComment, FaComments, FaVideo, FaMicrophone,
  FaHeadphones, FaKeyboard, FaMouse, FaDesktop, FaMobile,
  FaTablet, FaLaptop, FaTv, FaGamepad as FaController, 
  FaDiscord, FaSlack, FaWhatsapp, FaYoutube, FaTwitter
} from 'react-icons/fa'
import { 
  BiBot, BiAnalyse, BiTrendingUp, BiCoinStack, BiData,
  BiNetworkChart, BiPulse, BiRadar, BiTargetLock, BiGrid,
  BiStats, BiLineChart, BiBarChart, BiPieChart, BiScatterChart,
  BiCylinder, BiCube, BiPyramid, BiShapeCircle, BiShapePolygon,
  BiAlarm, BiTime, BiTimer, BiStopwatch, BiHourglass,
  BiCalendar, BiCalendarEvent, BiCalendarCheck, BiCalendarX, BiCalendarPlus
} from 'react-icons/bi'
import { 
  MdAutoGraph, MdAutorenew, MdSwapHoriz, MdTimeline,
  MdShowChart, MdCandlestickChart, MdStackedLineChart,
  MdMultilineChart, MdSignalCellularAlt, MdSpeed,
  MdWaterfall, MdBubbleChart, MdScatterPlot, MdPieChart,
  MdDonutLarge, MdBarChart, MdEqualizer, MdGraphicEq,
  MdLeaderboard, MdAnalytics, MdQueryStats, MdDataUsage
} from 'react-icons/md'
import { motion, AnimatePresence } from 'framer-motion'

// ÏÇ¨Ïö©Ïûê Ïó≠Ìï† Ï†ïÏùò
type UserRole = 'Î≥∏ÏÇ¨' | 'Ï¥ùÌåê' | 'ÎåÄÎ¶¨Ï†ê' | 'Íµ¨ÎèÖÏûê' | 'Í≤åÏä§Ìä∏'

// Íµ¨ÎèÖ Îì±Í∏â Ï†ïÏùò
type SubscriptionTier = 'Free' | 'Silver' | 'Gold' | 'Platinum' | 'Diamond' | 'Black'

// Î©îÎâ¥ Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÏùò (20Í∞úÎ°ú ÌôïÏû•)
type MenuCategory = 
  'signals' | 'quant' | 'microstructure' | 'technical' | 'ai' | 
  'automation' | 'telegram' | 'gaming' | 'macro' | 'crypto' | 
  'news' | 'events' | 'risk' | 'portfolio' | 'members' | 
  'payment' | 'marketing' | 'analytics' | 'education' | 'system'

// Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌÉÄÏûÖ
interface MenuItem {
  icon: any
  label: string
  path: string
  badge?: string
  category: MenuCategory
  minRole?: UserRole[]
  minTier?: SubscriptionTier
  isNew?: boolean
  isPremium?: boolean
  isHot?: boolean
  isAlpha?: boolean
  description?: string
}

// Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏÉâÏÉÅ ÌÖåÎßà (20Í∞ú)
const categoryThemes = {
  signals: { color: 'from-cyan-600 to-blue-600', bgColor: 'bg-cyan-500/20', borderColor: 'border-cyan-500/30' },
  quant: { color: 'from-purple-600 to-indigo-600', bgColor: 'bg-purple-500/20', borderColor: 'border-purple-500/30' },
  microstructure: { color: 'from-pink-600 to-rose-600', bgColor: 'bg-pink-500/20', borderColor: 'border-pink-500/30' },
  technical: { color: 'from-blue-600 to-indigo-600', bgColor: 'bg-blue-500/20', borderColor: 'border-blue-500/30' },
  ai: { color: 'from-violet-600 to-purple-600', bgColor: 'bg-violet-500/20', borderColor: 'border-violet-500/30' },
  automation: { color: 'from-green-600 to-emerald-600', bgColor: 'bg-green-500/20', borderColor: 'border-green-500/30' },
  telegram: { color: 'from-sky-600 to-blue-600', bgColor: 'bg-sky-500/20', borderColor: 'border-sky-500/30' },
  gaming: { color: 'from-orange-600 to-red-600', bgColor: 'bg-orange-500/20', borderColor: 'border-orange-500/30' },
  macro: { color: 'from-teal-600 to-cyan-600', bgColor: 'bg-teal-500/20', borderColor: 'border-teal-500/30' },
  crypto: { color: 'from-yellow-600 to-amber-600', bgColor: 'bg-yellow-500/20', borderColor: 'border-yellow-500/30' },
  news: { color: 'from-lime-600 to-green-600', bgColor: 'bg-lime-500/20', borderColor: 'border-lime-500/30' },
  events: { color: 'from-amber-600 to-orange-600', bgColor: 'bg-amber-500/20', borderColor: 'border-amber-500/30' },
  risk: { color: 'from-red-600 to-rose-600', bgColor: 'bg-red-500/20', borderColor: 'border-red-500/30' },
  portfolio: { color: 'from-indigo-600 to-blue-600', bgColor: 'bg-indigo-500/20', borderColor: 'border-indigo-500/30' },
  members: { color: 'from-slate-600 to-gray-600', bgColor: 'bg-slate-500/20', borderColor: 'border-slate-500/30' },
  payment: { color: 'from-emerald-600 to-green-600', bgColor: 'bg-emerald-500/20', borderColor: 'border-emerald-500/30' },
  marketing: { color: 'from-fuchsia-600 to-pink-600', bgColor: 'bg-fuchsia-500/20', borderColor: 'border-fuchsia-500/30' },
  analytics: { color: 'from-blue-700 to-indigo-700', bgColor: 'bg-blue-600/20', borderColor: 'border-blue-600/30' },
  education: { color: 'from-purple-700 to-pink-700', bgColor: 'bg-purple-600/20', borderColor: 'border-purple-600/30' },
  system: { color: 'from-gray-700 to-slate-700', bgColor: 'bg-gray-600/20', borderColor: 'border-gray-600/30' }
}

// Ï¢ÖÌï© Î©îÎâ¥ Íµ¨Ï°∞ (20Í∞ú Ïπ¥ÌÖåÍ≥†Î¶¨, 300+ Ìï≠Î™©)
const menuStructure: { [key in MenuCategory]: { title: string, items: MenuItem[] } } = {
  signals: {
    title: 'üì° ÌîÑÎ¶¨ÎØ∏ÏóÑ ÏãúÍ∑∏ÎÑê',
    items: [
      { icon: FaSignal, label: 'Smart Money Signals', path: '/signals/smart-money', badge: 'HOT', category: 'signals', isHot: true },
      { icon: FaWater, label: 'Insider Flow', path: '/signals/insider', category: 'signals', minTier: 'Gold' },
      { icon: FaExchangeAlt, label: 'Cross-Exchange Arb', path: '/signals/arbitrage', category: 'signals', minTier: 'Platinum' },
      { icon: FaPercentage, label: 'Funding Rate Signals', path: '/signals/funding', category: 'signals' },
      { icon: BiTargetLock, label: 'Options Flow', path: '/signals/options', category: 'signals', minTier: 'Diamond' },
      { icon: FaCoins, label: 'DeFi TVL Signals', path: '/signals/defi-tvl', category: 'signals' },
      { icon: FaDollarSign, label: 'Stablecoin Flow', path: '/signals/stablecoin', category: 'signals' },
      { icon: FaMicrochip, label: 'Mining Pool Signals', path: '/signals/mining', category: 'signals', minTier: 'Silver' },
      { icon: FaSkull, label: 'Liquidation Alerts', path: '/signals/liquidation', badge: 'ÏúÑÌóò', category: 'signals' },
      { icon: FaWhatsapp, label: 'Whale Alerts', path: '/signals/whale', category: 'signals', isPremium: true },
    ]
  },
  quant: {
    title: 'üß† ÌÄÄÌä∏ Ï†ÑÎûµ',
    items: [
      { icon: BiLineChart, label: 'Mean Reversion', path: '/quant/mean-reversion', category: 'quant' },
      { icon: FaRocket, label: 'Momentum Strategies', path: '/quant/momentum', badge: 'PRO', category: 'quant', minTier: 'Gold' },
      { icon: FaBalanceScale, label: 'Statistical Arbitrage', path: '/quant/stat-arb', category: 'quant', minTier: 'Platinum' },
      { icon: BiNetworkChart, label: 'Pairs Trading', path: '/quant/pairs', category: 'quant' },
      { icon: FaShieldAlt, label: 'Market Neutral', path: '/quant/neutral', category: 'quant', minTier: 'Diamond' },
      { icon: FaBolt, label: 'HFT Strategies', path: '/quant/hft', badge: 'Í∑πÏÜç', category: 'quant', minTier: 'Black', isAlpha: true },
      { icon: FaBrain, label: 'ML Strategies', path: '/quant/ml', category: 'quant', minTier: 'Gold' },
      { icon: FaBitcoin, label: 'Crypto-Specific', path: '/quant/crypto', category: 'quant' },
      { icon: BiCube, label: 'Factor Models', path: '/quant/factor', category: 'quant', minTier: 'Platinum' },
      { icon: FaInfinity, label: 'Cointegration', path: '/quant/cointegration', category: 'quant' },
    ]
  },
  microstructure: {
    title: 'üîÆ ÏãúÏû• ÎØ∏ÏãúÍµ¨Ï°∞',
    items: [
      { icon: BiBarChart, label: 'Order Book Imbalance', path: '/micro/imbalance', category: 'microstructure' },
      { icon: FaWaveSquare, label: 'Microstructure Noise', path: '/micro/noise', category: 'microstructure', minTier: 'Gold' },
      { icon: BiPulse, label: 'Tick Data Analysis', path: '/micro/tick', category: 'microstructure' },
      { icon: BiScatterChart, label: 'Trade Size Distribution', path: '/micro/size', category: 'microstructure' },
      { icon: FaEye, label: 'Spoofing Detection', path: '/micro/spoofing', badge: 'Í∞êÏßÄ', category: 'microstructure' },
      { icon: FaRadiation, label: 'Wash Trading Detection', path: '/micro/wash', category: 'microstructure' },
      { icon: FaCrosshairs, label: 'Front-Running Analysis', path: '/micro/frontrun', category: 'microstructure', minTier: 'Diamond' },
      { icon: FaBullseye, label: 'Sandwich Attack Monitor', path: '/micro/sandwich', badge: 'MEV', category: 'microstructure' },
      { icon: BiRadar, label: 'Latency Arbitrage', path: '/micro/latency', category: 'microstructure', minTier: 'Black' },
      { icon: FaChess, label: 'Market Manipulation', path: '/micro/manipulation', category: 'microstructure' },
    ]
  },
  technical: {
    title: 'üìä Í∏∞Ïà†Ï†Å Î∂ÑÏÑù',
    items: [
      { icon: FaChartLine, label: 'Moving Averages', path: '/technical/ma', category: 'technical' },
      { icon: MdShowChart, label: 'RSI/MACD/Stoch', path: '/technical/indicators', category: 'technical' },
      { icon: MdCandlestickChart, label: 'Elliott Wave', path: '/technical/elliott', badge: 'PRO', category: 'technical', minTier: 'Gold' },
      { icon: FaWaveSquare, label: 'Wyckoff Method', path: '/technical/wyckoff', category: 'technical', minTier: 'Platinum' },
      { icon: FaChessQueen, label: 'Smart Money Concepts', path: '/technical/smc', badge: 'HOT', category: 'technical', isHot: true },
      { icon: BiGrid, label: 'Order Flow', path: '/technical/orderflow', category: 'technical', minTier: 'Gold' },
      { icon: FaChartArea, label: 'Market Profile', path: '/technical/profile', category: 'technical' },
      { icon: FaVolumeUp, label: 'Volume Profile', path: '/technical/volume', category: 'technical' },
      { icon: BiData, label: 'CVD/Delta', path: '/technical/cvd', category: 'technical' },
      { icon: FaAnchor, label: 'ÏßÄÏßÄ/Ï†ÄÌï≠ ÏûêÎèôÌÉêÏßÄ', path: '/technical/support', category: 'technical' },
      { icon: MdWaterfall, label: 'OFI Analysis', path: '/technical/ofi', badge: 'NEW', category: 'technical', isNew: true },
      { icon: FaFire, label: 'Ïú†ÎèôÏÑ± ÏÇ¨ÎÉ•', path: '/technical/liquidity', category: 'technical', minTier: 'Diamond' },
      { icon: FaSkull, label: 'Ïò§ÎπÑÏ∂îÏñ¥Î¶¨ Ìå®ÌÑ¥', path: '/technical/obituary', category: 'technical', minTier: 'Black', isAlpha: true },
      { icon: FaPuzzlePiece, label: 'Harmonic Patterns', path: '/technical/harmonic', category: 'technical' },
      { icon: BiShapePolygon, label: 'Fibonacci Tools', path: '/technical/fibonacci', category: 'technical' },
    ]
  },
  ai: {
    title: 'ü§ñ AI/ML Î∂ÑÏÑù',
    items: [
      { icon: FaRobot, label: 'GPT-4 Î∂ÑÏÑù', path: '/ai/gpt4', badge: 'AI', category: 'ai', isHot: true },
      { icon: FaBrain, label: 'Claude ÏöîÏïΩ', path: '/ai/claude', category: 'ai' },
      { icon: BiAnalyse, label: 'LSTM ÏòàÏ∏°', path: '/ai/lstm', category: 'ai', minTier: 'Gold' },
      { icon: BiStats, label: 'GRU Î™®Îç∏', path: '/ai/gru', category: 'ai' },
      { icon: MdTimeline, label: 'ARIMA ÏãúÍ≥ÑÏó¥', path: '/ai/arima', category: 'ai' },
      { icon: FaDna, label: 'Random Forest', path: '/ai/rf', category: 'ai' },
      { icon: FaAtom, label: 'XGBoost', path: '/ai/xgboost', category: 'ai', minTier: 'Silver' },
      { icon: FaMagic, label: 'LightGBM', path: '/ai/lightgbm', category: 'ai' },
      { icon: BiPyramid, label: 'BERT Í∞êÏÑ±Î∂ÑÏÑù', path: '/ai/bert', category: 'ai', minTier: 'Platinum' },
      { icon: FaInfinity, label: 'Transformer', path: '/ai/transformer', category: 'ai', minTier: 'Diamond' },
      { icon: FaSpaceShuttle, label: 'GAN ÏãúÎÇòÎ¶¨Ïò§', path: '/ai/gan', badge: 'ÏµúÏ≤®Îã®', category: 'ai', minTier: 'Black' },
      { icon: BiCylinder, label: 'Freqtrade ÌÜµÌï©', path: '/ai/freqtrade', category: 'ai' },
      { icon: MdAutoGraph, label: 'ÏïôÏÉÅÎ∏î Ïä§ÏΩîÏñ¥', path: '/ai/ensemble', badge: 'Ï¢ÖÌï©', category: 'ai' },
    ]
  },
  automation: {
    title: '‚ö° ÏûêÎèôÎß§Îß§ Î¥á',
    items: [
      { icon: BiBot, label: 'Grid Bot', path: '/bots/grid', category: 'automation' },
      { icon: MdAutorenew, label: 'DCA Bot', path: '/bots/dca', category: 'automation' },
      { icon: FaRocket, label: 'Sniper Bot', path: '/bots/sniper', badge: 'Í∑πÏÜç', category: 'automation', minTier: 'Platinum' },
      { icon: FaMicrochip, label: 'MEV Bot', path: '/bots/mev', badge: 'PRO', category: 'automation', minTier: 'Diamond' },
      { icon: FaExchangeAlt, label: 'Arbitrage Bot', path: '/bots/arbitrage', category: 'automation', minTier: 'Gold' },
      { icon: FaBalanceScale, label: 'Market Making Bot', path: '/bots/market-making', category: 'automation', minTier: 'Black' },
      { icon: FaHistory, label: 'Backtesting', path: '/bots/backtest', category: 'automation' },
      { icon: BiTargetLock, label: 'Strategy Builder', path: '/bots/builder', category: 'automation' },
      { icon: FaFlask, label: 'Walk-Forward', path: '/bots/walk-forward', category: 'automation', minTier: 'Gold' },
      { icon: FaDice, label: 'Monte Carlo', path: '/bots/monte-carlo', category: 'automation' },
      { icon: FaShieldAlt, label: 'Risk Manager', path: '/bots/risk', category: 'automation' },
    ]
  },
  telegram: {
    title: 'üí¨ ÌÖîÎ†àÍ∑∏Îû® Î¥á',
    items: [
      { icon: FaTelegram, label: 'Ïã§ÏãúÍ∞Ñ ÏãúÍ∑∏ÎÑê', path: '/telegram/signals', badge: 'LIVE', category: 'telegram', isHot: true },
      { icon: FaPaperPlane, label: 'ÏõêÌÅ¥Î¶≠ ÏûêÎèôÎß§Îß§', path: '/telegram/auto', category: 'telegram', minTier: 'Silver' },
      { icon: FaGamepad, label: 'ÌÄµÎ∞∞ÌãÄ Í≤åÏûÑ', path: '/telegram/battle', badge: 'GAME', category: 'telegram', isNew: true },
      { icon: FaTrophy, label: 'ÌÜ†ÎÑàÎ®ºÌä∏', path: '/telegram/tournament', category: 'telegram' },
      { icon: FaChartPie, label: 'ÏòàÏ∏° Ï∞®Ìä∏ Ïù¥ÎØ∏ÏßÄ', path: '/telegram/charts', category: 'telegram' },
      { icon: FaGlobe, label: '10Í∞ú Ïñ∏Ïñ¥ ÏßÄÏõê', path: '/telegram/language', category: 'telegram' },
      { icon: FaBell, label: 'Ïª§Ïä§ÌÖÄ ÏïåÎ¶º', path: '/telegram/alerts', category: 'telegram' },
      { icon: FaUsers, label: 'Í∑∏Î£π Í¥ÄÎ¶¨', path: '/telegram/groups', category: 'telegram', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaBroadcastTower, label: 'Î∞©ÏÜ° Ï±ÑÎÑê', path: '/telegram/broadcast', category: 'telegram' },
      { icon: FaRobot, label: 'Î¥á ÏÑ§Ï†ï', path: '/telegram/settings', category: 'telegram' },
    ]
  },
  gaming: {
    title: 'üéÆ Í≤åÏûÑÌôî & ÏÜåÏÖú',
    items: [
      { icon: FaTrophy, label: 'Ìä∏Î†àÏù¥Îî© ÎåÄÌöå', path: '/gaming/competition', badge: 'LIVE', category: 'gaming' },
      { icon: FaGamepad, label: 'ÌÄµÎ∞∞ÌãÄ', path: '/gaming/quick-battle', category: 'gaming', isNew: true },
      { icon: FaMedal, label: 'Î¶¨ÎçîÎ≥¥Îìú', path: '/gaming/leaderboard', category: 'gaming' },
      { icon: FaAward, label: 'ÏóÖÏ†Å ÏãúÏä§ÌÖú', path: '/gaming/achievements', category: 'gaming' },
      { icon: FaStar, label: 'Î†àÎ≤®/Í≤ΩÌóòÏπò', path: '/gaming/levels', category: 'gaming' },
      { icon: FaGem, label: 'Î±ÉÏßÄ Ïª¨Î†âÏÖò', path: '/gaming/badges', category: 'gaming' },
      { icon: FaGift, label: 'ÏùºÏùº ÌÄòÏä§Ìä∏', path: '/gaming/quests', category: 'gaming' },
      { icon: BiNetworkChart, label: 'Copy Trading', path: '/gaming/copy', badge: 'Ïù∏Í∏∞', category: 'gaming', minTier: 'Gold' },
      { icon: FaVideo, label: 'Live Streaming', path: '/gaming/streaming', category: 'gaming' },
      { icon: FaComments, label: 'Trading Rooms', path: '/gaming/rooms', category: 'gaming' },
      { icon: FaHandshake, label: 'Mentor Matching', path: '/gaming/mentor', category: 'gaming', minTier: 'Platinum' },
      { icon: FaTheaterMasks, label: 'VIP ÎùºÏö¥ÏßÄ', path: '/gaming/vip', badge: 'VIP', category: 'gaming', minTier: 'Diamond' },
    ]
  },
  macro: {
    title: 'üåê Í∏ÄÎ°úÎ≤å Îß§ÌÅ¨Î°ú',
    items: [
      { icon: FaUniversity, label: 'Fed Policy Tracker', path: '/macro/fed', category: 'macro' },
      { icon: FaMoneyBillWave, label: 'Global Liquidity', path: '/macro/liquidity', category: 'macro' },
      { icon: FaDollarSign, label: 'Dollar Strength', path: '/macro/dollar', category: 'macro' },
      { icon: FaChartBar, label: 'Inflation Expectations', path: '/macro/inflation', category: 'macro' },
      { icon: FaExclamationTriangle, label: 'Risk On/Off', path: '/macro/risk', badge: 'Ï§ëÏöî', category: 'macro' },
      { icon: BiStats, label: 'Correlation Analysis', path: '/macro/correlation', category: 'macro', minTier: 'Gold' },
      { icon: FaFlag, label: 'Geopolitical Risk', path: '/macro/geopolitical', category: 'macro' },
      { icon: FaNewspaper, label: 'Regulatory Impact', path: '/macro/regulatory', category: 'macro' },
      { icon: FaCalculator, label: 'Interest Rates', path: '/macro/rates', category: 'macro' },
      { icon: FaPiggyBank, label: 'Central Bank Watch', path: '/macro/central-banks', category: 'macro' },
    ]
  },
  crypto: {
    title: 'üíé ÌÅ¨Î¶ΩÌÜ† ÎÑ§Ïù¥Ìã∞Î∏å',
    items: [
      { icon: BiLineChart, label: 'NVT Signal', path: '/crypto/nvt', category: 'crypto' },
      { icon: BiBarChart, label: 'MVRV Z-Score', path: '/crypto/mvrv', category: 'crypto', minTier: 'Silver' },
      { icon: BiPieChart, label: 'SOPR Analysis', path: '/crypto/sopr', category: 'crypto' },
      { icon: FaMicrochip, label: 'Puell Multiple', path: '/crypto/puell', category: 'crypto' },
      { icon: FaInfinity, label: 'Stock-to-Flow', path: '/crypto/s2f', category: 'crypto' },
      { icon: FaWaveSquare, label: 'HODL Waves', path: '/crypto/hodl', category: 'crypto', minTier: 'Gold' },
      { icon: FaExchangeAlt, label: 'Exchange Flows', path: '/crypto/exchange', category: 'crypto' },
      { icon: FaDollarSign, label: 'Stablecoin Ratio', path: '/crypto/stablecoin', category: 'crypto' },
      { icon: BiCoinStack, label: 'Bitcoin Dominance', path: '/crypto/dominance', category: 'crypto' },
      { icon: FaEthereum, label: 'ETH Burn Rate', path: '/crypto/eth-burn', category: 'crypto' },
      { icon: FaCoins, label: 'Altcoin Season', path: '/crypto/altseason', badge: 'HOT', category: 'crypto' },
    ]
  },
  news: {
    title: 'üì∞ Îâ¥Ïä§ & ÎØ∏ÎîîÏñ¥',
    items: [
      { icon: FaNewspaper, label: 'AI ÌÅ¨Î°§ÎßÅ Îâ¥Ïä§', path: '/news/ai-crawl', badge: '100+', category: 'news' },
      { icon: FaBrain, label: 'AI Ïû¨ÏûëÏÑ±', path: '/news/ai-rewrite', category: 'news' },
      { icon: FaSearch, label: 'Ìà¨ÏûêÏûê Í¥ÄÏ†ê Î∂ÑÏÑù', path: '/news/investor', category: 'news' },
      { icon: FaYoutube, label: 'YouTube ÌÜµÌï©', path: '/news/youtube', category: 'news' },
      { icon: FaTwitter, label: 'Twitter ÏÑºÌã∞Î©òÌä∏', path: '/news/twitter', category: 'news' },
      { icon: FaGlobe, label: 'Ï∂îÏ≤ú ÏÇ¨Ïù¥Ìä∏', path: '/news/sites', category: 'news' },
      { icon: FaEnvelope, label: 'Îâ¥Ïä§Î†àÌÑ∞', path: '/news/newsletter', category: 'news' },
      { icon: FaMicrophone, label: 'ÌåüÏ∫êÏä§Ìä∏', path: '/news/podcast', category: 'news' },
      { icon: FaBook, label: 'Î¶¨ÏÑúÏπò Î¶¨Ìè¨Ìä∏', path: '/news/research', category: 'news', minTier: 'Gold' },
      { icon: FaComment, label: 'Ï†ÑÎ¨∏Í∞Ä ÏùòÍ≤¨', path: '/news/experts', category: 'news' },
    ]
  },
  events: {
    title: '‚ö° Ïã§ÏãúÍ∞Ñ Ïù¥Î≤§Ìä∏',
    items: [
      { icon: FaRocket, label: 'Í±∞ÎûòÏÜå ÏÉÅÏû•', path: '/events/listings', badge: 'NEW', category: 'events', isNew: true },
      { icon: FaHandshake, label: 'ÌååÌä∏ÎÑàÏã≠ Î∞úÌëú', path: '/events/partnerships', category: 'events' },
      { icon: FaNetworkWired, label: 'Î©îÏù∏ÎÑ∑ Îü∞Ïπ≠', path: '/events/mainnet', category: 'events' },
      { icon: FaGift, label: 'Fork/Airdrop', path: '/events/airdrop', category: 'events' },
      { icon: FaFire, label: 'Burning Events', path: '/events/burning', category: 'events' },
      { icon: FaCoins, label: 'Staking Rewards', path: '/events/staking', category: 'events' },
      { icon: FaPercentage, label: 'DeFi Yields', path: '/events/yields', category: 'events' },
      { icon: FaBallotCheck, label: 'Governance Votes', path: '/events/governance', category: 'events' },
      { icon: FaCalendar, label: 'Token Unlocks', path: '/events/unlocks', badge: 'Ï§ëÏöî', category: 'events' },
      { icon: FaMicrochip, label: 'Protocol Upgrades', path: '/events/upgrades', category: 'events' },
    ]
  },
  risk: {
    title: 'üîç Î¶¨Ïä§ÌÅ¨ Î™®ÎãàÌÑ∞',
    items: [
      { icon: FaFire, label: 'Liquidation Heatmap', path: '/risk/liquidation', badge: 'ÏúÑÌóò', category: 'risk' },
      { icon: FaExclamationTriangle, label: 'Cascade Risk', path: '/risk/cascade', category: 'risk' },
      { icon: FaBolt, label: 'Flash Crash Alert', path: '/risk/flash', category: 'risk' },
      { icon: FaSkull, label: 'Rug Pull Detector', path: '/risk/rugpull', category: 'risk' },
      { icon: FaShieldAlt, label: 'Smart Contract Risk', path: '/risk/contract', category: 'risk' },
      { icon: FaNetworkWired, label: 'Bridge Hack Monitor', path: '/risk/bridge', category: 'risk' },
      { icon: FaUniversity, label: 'Exchange Solvency', path: '/risk/solvency', category: 'risk', minTier: 'Gold' },
      { icon: MdQueryStats, label: 'Systemic Risk Index', path: '/risk/systemic', category: 'risk', minTier: 'Platinum' },
      { icon: FaRadiation, label: 'Black Swan Alert', path: '/risk/blackswan', badge: 'Í∑πÌïú', category: 'risk', minTier: 'Diamond' },
      { icon: BiAlarm, label: 'Risk Dashboard', path: '/risk/dashboard', category: 'risk' },
    ]
  },
  portfolio: {
    title: 'üíº Ìè¨Ìä∏Ìè¥Î¶¨Ïò§',
    items: [
      { icon: FaBriefcase, label: 'ÏûêÏÇ∞ ÎåÄÏãúÎ≥¥Îìú', path: '/portfolio/assets', category: 'portfolio' },
      { icon: FaCalculator, label: 'Position Sizing', path: '/portfolio/sizing', category: 'portfolio' },
      { icon: FaBalanceScale, label: 'Risk/Reward', path: '/portfolio/risk-reward', category: 'portfolio' },
      { icon: FaChartBar, label: 'Max Drawdown', path: '/portfolio/drawdown', category: 'portfolio' },
      { icon: FaChartArea, label: 'Portfolio Heatmap', path: '/portfolio/heatmap', category: 'portfolio' },
      { icon: BiStats, label: 'VAR Í≥ÑÏÇ∞', path: '/portfolio/var', category: 'portfolio', minTier: 'Gold' },
      { icon: BiNetworkChart, label: 'Correlation Matrix', path: '/portfolio/correlation', category: 'portfolio' },
      { icon: FaPieChart, label: 'Asset Allocation', path: '/portfolio/allocation', category: 'portfolio' },
      { icon: MdAnalytics, label: 'Performance Analytics', path: '/portfolio/performance', category: 'portfolio' },
      { icon: FaWallet, label: 'Wallet Tracker', path: '/portfolio/wallets', category: 'portfolio' },
    ]
  },
  members: {
    title: 'üë• ÌöåÏõê Í¥ÄÎ¶¨',
    items: [
      { icon: FaUsers, label: 'Ï†ÑÏ≤¥ ÌöåÏõê Ï°∞Ìöå', path: '/members/all', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaUserTie, label: 'Ïó≠Ìï† Í¥ÄÎ¶¨', path: '/members/roles', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaKey, label: 'Í∂åÌïú ÏÑ§Ï†ï', path: '/members/permissions', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaStore, label: 'Ï¥ùÌåê Í¥ÄÎ¶¨', path: '/members/distributors', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaHandshake, label: 'ÎåÄÎ¶¨Ï†ê Í¥ÄÎ¶¨', path: '/members/agencies', category: 'members', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaGem, label: 'Íµ¨ÎèÖÏûê Í¥ÄÎ¶¨', path: '/members/subscribers', category: 'members', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê', 'ÎåÄÎ¶¨Ï†ê'] },
      { icon: BiTimer, label: 'ÌôúÎèô Î°úÍ∑∏', path: '/members/logs', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaEnvelope, label: 'ÎåÄÎüâ Î©îÏãúÏßÄ', path: '/members/broadcast', category: 'members', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaSkull, label: 'Î∏îÎûôÎ¶¨Ïä§Ìä∏', path: '/members/blacklist', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaCrown, label: 'VIP Í¥ÄÎ¶¨', path: '/members/vip', category: 'members', minRole: ['Î≥∏ÏÇ¨'] },
    ]
  },
  payment: {
    title: 'üí∞ Í≤∞Ï†ú & Ï†ïÏÇ∞',
    items: [
      { icon: FaDollarSign, label: 'Îß§Ï∂ú ÎåÄÏãúÎ≥¥Îìú', path: '/payment/revenue', category: 'payment', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaMoneyBillWave, label: 'Ï†ïÏÇ∞ Í¥ÄÎ¶¨', path: '/payment/settlement', category: 'payment', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaPercentage, label: 'ÏàòÏàòÎ£å ÏÑ§Ï†ï', path: '/payment/commission', category: 'payment', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaHandshake, label: 'Î¶¨ÌçºÎü¥ Ï†ïÏÇ∞', path: '/payment/referral', category: 'payment' },
      { icon: FaBitcoin, label: 'ÏïîÌò∏ÌôîÌèê Í≤∞Ï†ú', path: '/payment/crypto', category: 'payment' },
      { icon: FaCreditCard, label: 'Ïπ¥Îìú Í≤∞Ï†ú', path: '/payment/card', category: 'payment' },
      { icon: FaWallet, label: 'Ï∂úÍ∏à Í¥ÄÎ¶¨', path: '/payment/withdrawal', category: 'payment' },
      { icon: FaReceipt, label: 'ÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú', path: '/payment/tax', category: 'payment', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaGift, label: 'Ïø†Ìè∞ ÏãúÏä§ÌÖú', path: '/payment/coupon', category: 'payment' },
      { icon: FaInfinity, label: 'Ï†ïÍ∏∞ Íµ¨ÎèÖ', path: '/payment/subscription', category: 'payment' },
    ]
  },
  marketing: {
    title: 'üì¢ ÎßàÏºÄÌåÖ',
    items: [
      { icon: FaBullhorn, label: 'Ï∫†ÌéòÏù∏ Í¥ÄÎ¶¨', path: '/marketing/campaigns', category: 'marketing', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaTicketAlt, label: 'Ïø†Ìè∞ Î∞úÌñâ', path: '/marketing/coupons', category: 'marketing' },
      { icon: FaUsers, label: 'Ï∂îÏ≤úÏù∏ ÌîÑÎ°úÍ∑∏Îû®', path: '/marketing/referral', category: 'marketing' },
      { icon: FaCalendarCheck, label: 'Ïù¥Î≤§Ìä∏ Í¥ÄÎ¶¨', path: '/marketing/events', category: 'marketing' },
      { icon: FaShare, label: 'SNS Ïó∞Îèô', path: '/marketing/social', category: 'marketing' },
      { icon: FaEnvelope, label: 'Ïù¥Î©îÏùº ÎßàÏºÄÌåÖ', path: '/marketing/email', category: 'marketing' },
      { icon: FaChartLine, label: 'A/B ÌÖåÏä§ÌåÖ', path: '/marketing/ab-test', category: 'marketing', minTier: 'Gold' },
      { icon: FaGift, label: 'Î≥¥ÏÉÅ ÏãúÏä§ÌÖú', path: '/marketing/rewards', category: 'marketing' },
      { icon: FaBroadcastTower, label: 'Ìë∏Ïãú ÏïåÎ¶º', path: '/marketing/push', category: 'marketing' },
      { icon: FaAd, label: 'Í¥ëÍ≥† Í¥ÄÎ¶¨', path: '/marketing/ads', category: 'marketing', minRole: ['Î≥∏ÏÇ¨'] },
    ]
  },
  analytics: {
    title: 'üìä ÎπÑÏ¶àÎãàÏä§ Î∂ÑÏÑù',
    items: [
      { icon: MdAnalytics, label: 'Ïã§ÏãúÍ∞Ñ ÎåÄÏãúÎ≥¥Îìú', path: '/analytics/dashboard', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: BiStats, label: 'Í∞ÄÏûÖ ÌÜµÍ≥Ñ', path: '/analytics/signup', category: 'analytics', minRole: ['Î≥∏ÏÇ¨', 'Ï¥ùÌåê'] },
      { icon: FaChartBar, label: 'Ïù¥ÌÉàÎ•† Î∂ÑÏÑù', path: '/analytics/churn', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaDollarSign, label: 'LTV Î∂ÑÏÑù', path: '/analytics/ltv', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: BiPieChart, label: 'CAC Î∂ÑÏÑù', path: '/analytics/cac', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: MdTimeline, label: 'ÏΩîÌò∏Ìä∏ Î∂ÑÏÑù', path: '/analytics/cohort', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaFunnel, label: 'ÌçºÎÑê Î∂ÑÏÑù', path: '/analytics/funnel', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: BiLineChart, label: 'ÏàòÏùµ ÏòàÏ∏°', path: '/analytics/forecast', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: FaRoute, label: 'Customer Journey', path: '/analytics/journey', category: 'analytics', minRole: ['Î≥∏ÏÇ¨'] },
      { icon: MdLeaderboard, label: 'Ïã§Ï†Å ÏàúÏúÑ', path: '/analytics/ranking', category: 'analytics' },
    ]
  },
  education: {
    title: 'üéì ÍµêÏú° ÏÑºÌÑ∞',
    items: [
      { icon: FaGraduationCap, label: 'Ìä∏Î†àÏù¥Îî© ÏïÑÏπ¥Îç∞ÎØ∏', path: '/education/academy', category: 'education' },
      { icon: FaBook, label: 'Ï†ÑÎûµ Í∞ÄÏù¥Îìú', path: '/education/strategy', category: 'education' },
      { icon: FaVideo, label: 'Ïõ®ÎπÑÎÇò', path: '/education/webinar', category: 'education' },
      { icon: FaUserGraduate, label: '1:1 Î©òÌÜ†ÎßÅ', path: '/education/mentoring', category: 'education', minTier: 'Platinum' },
      { icon: FaCertificate, label: 'Ïù∏Ï¶ùÏÑú Î∞úÍ∏â', path: '/education/certificate', category: 'education' },
      { icon: FaChalkboardTeacher, label: 'Ï¥àÍ∏â ÏΩîÏä§', path: '/education/beginner', category: 'education' },
      { icon: FaUserTie, label: 'Ï§ëÍ∏â ÏΩîÏä§', path: '/education/intermediate', category: 'education', minTier: 'Silver' },
      { icon: FaCrown, label: 'Í≥†Í∏â ÏΩîÏä§', path: '/education/advanced', category: 'education', minTier: 'Gold' },
      { icon: FaRocket, label: 'Ï†ÑÎ¨∏Í∞Ä ÏΩîÏä§', path: '/education/expert', category: 'education', minTier: 'Diamond' },
      { icon: FaUsers, label: 'Ïª§ÎÆ§ÎãàÌã∞', path: '/education/community', category: 'education' },
    ]
  },
  system: {
    title: '‚öôÔ∏è ÏãúÏä§ÌÖú ÏÑ§Ï†ï',
    items: [
      { icon: FaUser, label: 'ÌîÑÎ°úÌïÑ', path: '/system/profile', category: 'system' },
      { icon: FaCog, label: 'ÏùºÎ∞ò ÏÑ§Ï†ï', path: '/system/settings', category: 'system' },
      { icon: FaShieldAlt, label: 'Î≥¥Ïïà ÏÑ§Ï†ï', path: '/system/security', category: 'system' },
      { icon: FaKey, label: 'API ÌÇ§ Í¥ÄÎ¶¨', path: '/system/api-keys', category: 'system' },
      { icon: FaExchangeAlt, label: 'Í±∞ÎûòÏÜå Ïó∞Îèô', path: '/system/exchanges', category: 'system' },
      { icon: FaDatabase, label: 'Î∞±ÏóÖ & Î≥µÍµ¨', path: '/system/backup', category: 'system', minTier: 'Silver' },
      { icon: FaServer, label: 'ÏÑúÎ≤Ñ ÏÉÅÌÉú', path: '/system/status', category: 'system' },
      { icon: FaCloud, label: 'ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî', path: '/system/sync', category: 'system', minTier: 'Gold' },
      { icon: FaGlobe, label: 'Ïñ∏Ïñ¥ ÏÑ§Ï†ï', path: '/system/language', category: 'system' },
      { icon: FaMoon, label: 'ÌÖåÎßà ÏÑ§Ï†ï', path: '/system/theme', category: 'system' },
    ]
  }
}

export default function SidebarNew() {
  const [isOpen, setIsOpen] = useState(true)
  const [isHovered, setIsHovered] = useState(false)
  const [expandedCategories, setExpandedCategories] = useState<MenuCategory[]>(['signals'])
  const pathname = usePathname()
  
  // ÏûÑÏãú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ (ÎÇòÏ§ëÏóê Ïã§Ï†ú Ïù∏Ï¶ù ÏãúÏä§ÌÖúÍ≥º Ïó∞Îèô)
  const [currentUser] = useState({
    role: 'Î≥∏ÏÇ¨' as UserRole,
    tier: 'Black' as SubscriptionTier,
    name: 'Í¥ÄÎ¶¨Ïûê'
  })

  const toggleSidebar = () => setIsOpen(!isOpen)
  
  const toggleCategory = (category: MenuCategory) => {
    setExpandedCategories(prev => 
      prev.includes(category) 
        ? prev.filter(c => c !== category)
        : [...prev, category]
    )
  }
  
  // Ïó≠Ìï† Í∏∞Î∞ò Ï†ëÍ∑º Í∂åÌïú ÌôïÏù∏
  const hasRoleAccess = (minRole?: UserRole[]) => {
    if (!minRole) return true
    return minRole.includes(currentUser.role)
  }
  
  // Íµ¨ÎèÖ Îì±Í∏â Í∏∞Î∞ò Ï†ëÍ∑º Í∂åÌïú ÌôïÏù∏
  const hasTierAccess = (minTier?: SubscriptionTier) => {
    if (!minTier) return true
    const tiers: SubscriptionTier[] = ['Free', 'Silver', 'Gold', 'Platinum', 'Diamond', 'Black']
    const currentTierIndex = tiers.indexOf(currentUser.tier)
    const requiredTierIndex = tiers.indexOf(minTier)
    return currentTierIndex >= requiredTierIndex
  }
  
  // Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌïÑÌÑ∞ÎßÅ
  const filterMenuItems = (items: MenuItem[]) => {
    return items.filter(item => 
      hasRoleAccess(item.minRole) && hasTierAccess(item.minTier)
    )
  }

  return (
    <>
      {/* Mobile Menu Button */}
      <button
        onClick={toggleSidebar}
        className="lg:hidden fixed top-4 left-4 z-50 p-2 bg-gray-800 rounded-lg text-white"
      >
        {isOpen ? <FaTimes size={20} /> : <FaBars size={20} />}
      </button>

      {/* Sidebar */}
      <motion.aside
        initial={{ x: -300 }}
        animate={{ x: 0 }}
        className={`
          fixed left-0 top-0 h-screen z-40
          bg-gradient-to-b from-gray-900 via-gray-900 to-black
          border-r border-gray-800
          transition-all duration-300 ease-in-out
          ${isOpen ? 'w-64' : 'w-20'}
        `}
        onMouseEnter={() => setIsHovered(true)}
        onMouseLeave={() => setIsHovered(false)}
      >
        {/* Logo */}
        <div className="p-6 border-b border-gray-800">
          <Link href="/" className="flex items-center gap-3">
            <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-xl flex items-center justify-center">
              <span className="text-white font-bold text-xl">M</span>
            </div>
            <AnimatePresence>
              {(isOpen || isHovered) && (
                <motion.div
                  initial={{ opacity: 0, x: -20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: -20 }}
                  className="flex flex-col"
                >
                  <span className="text-white font-bold text-xl">MONSTA</span>
                  <span className="text-gray-400 text-xs">World #1 Trading</span>
                </motion.div>
              )}
            </AnimatePresence>
          </Link>
        </div>

        {/* Toggle Button */}
        <button
          onClick={toggleSidebar}
          className="hidden lg:block absolute -right-3 top-9 w-6 h-6 bg-gray-800 rounded-full border border-gray-700 text-white text-xs hover:bg-gray-700 transition-colors"
        >
          {isOpen ? '‚óÄ' : '‚ñ∂'}
        </button>

        {/* Main Menu */}
        <nav className="flex-1 overflow-y-auto p-4 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent">
          <div className="space-y-3">
            {Object.entries(menuStructure).map(([category, section]) => {
              const theme = categoryThemes[category as MenuCategory]
              const isExpanded = expandedCategories.includes(category as MenuCategory)
              const filteredItems = filterMenuItems(section.items)
              
              if (filteredItems.length === 0) return null
              
              return (
                <motion.div
                  key={category}
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  className="space-y-1"
                >
                  {/* Category Header */}
                  <button
                    onClick={() => toggleCategory(category as MenuCategory)}
                    className={`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-all
                      ${theme.bgColor} ${theme.borderColor} border
                      hover:brightness-110 group
                    `}
                  >
                    <AnimatePresence>
                      {(isOpen || isHovered) && (
                        <motion.span
                          initial={{ opacity: 0 }}
                          animate={{ opacity: 1 }}
                          exit={{ opacity: 0 }}
                          className="text-sm font-bold text-white"
                        >
                          {section.title}
                        </motion.span>
                      )}
                    </AnimatePresence>
                    <motion.span
                      animate={{ rotate: isExpanded ? 180 : 0 }}
                      className="text-gray-400 group-hover:text-white"
                    >
                      ‚ñº
                    </motion.span>
                  </button>
                  
                  {/* Category Items */}
                  <AnimatePresence>
                    {isExpanded && (
                      <motion.ul
                        initial={{ height: 0, opacity: 0 }}
                        animate={{ height: 'auto', opacity: 1 }}
                        exit={{ height: 0, opacity: 0 }}
                        className="space-y-1 pl-2"
                      >
                        {filteredItems.map((item, index) => {
                          const Icon = item.icon
                          const isActive = pathname === item.path
                          const isLocked = !hasTierAccess(item.minTier)
                          
                          return (
                            <motion.li
                              key={item.path}
                              initial={{ opacity: 0, x: -10 }}
                              animate={{ opacity: 1, x: 0 }}
                              transition={{ delay: index * 0.02 }}
                            >
                              <Link
                                href={isLocked ? '#' : item.path}
                                className={`
                                  flex items-center gap-3 px-3 py-2 rounded-lg
                                  transition-all duration-200 relative group
                                  ${isActive 
                                    ? `bg-gradient-to-r ${theme.color} text-white shadow-lg` 
                                    : isLocked
                                    ? 'text-gray-600 hover:text-gray-500 bg-gray-900/50 cursor-not-allowed'
                                    : 'text-gray-400 hover:text-white hover:bg-gray-800'
                                  }
                                `}
                                onClick={isLocked ? (e) => e.preventDefault() : undefined}
                              >
                                <div className="relative">
                                  <Icon size={18} className="flex-shrink-0" />
                                  {isLocked && (
                                    <FaLock size={10} className="absolute -bottom-1 -right-1 text-yellow-500" />
                                  )}
                                </div>
                                <AnimatePresence>
                                  {(isOpen || isHovered) && (
                                    <motion.div
                                      initial={{ opacity: 0 }}
                                      animate={{ opacity: 1 }}
                                      exit={{ opacity: 0 }}
                                      className="flex-1 flex items-center justify-between"
                                    >
                                      <span className={`font-medium text-sm ${
                                        isLocked ? 'opacity-50' : ''
                                      }`}>
                                        {item.label}
                                      </span>
                                      <div className="flex items-center gap-1">
                                        {item.minTier && !hasTierAccess(item.minTier) && (
                                          <span className="px-1.5 py-0.5 text-xs bg-yellow-500/20 text-yellow-400 rounded-full font-bold">
                                            {item.minTier}
                                          </span>
                                        )}
                                        {item.isAlpha && (
                                          <span className="px-1.5 py-0.5 text-xs bg-black text-yellow-400 border border-yellow-400 rounded-full font-bold">
                                            ALPHA
                                          </span>
                                        )}
                                        {item.badge && (
                                          <span className={`
                                            px-1.5 py-0.5 text-xs rounded-full font-bold
                                            ${item.badge === 'LIVE' ? 'bg-red-500 text-white animate-pulse' :
                                              item.badge === 'HOT' || item.isHot ? 'bg-orange-500 text-white' :
                                              item.badge === 'NEW' || item.isNew ? 'bg-green-500 text-white' :
                                              item.badge === 'PRO' ? 'bg-purple-500 text-white' :
                                              item.badge === 'VIP' ? 'bg-gradient-to-r from-yellow-500 to-yellow-600 text-white' :
                                              item.badge === 'AI' ? 'bg-blue-500 text-white' :
                                              item.badge === 'GAME' ? 'bg-pink-500 text-white' :
                                              item.badge === 'MEV' ? 'bg-red-600 text-white' :
                                              item.badge === 'Í∑πÏÜç' ? 'bg-gradient-to-r from-red-500 to-orange-500 text-white' :
                                              item.badge === 'ÏµúÏ≤®Îã®' ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white' :
                                              item.badge === 'Ï¢ÖÌï©' ? 'bg-gradient-to-r from-blue-500 to-green-500 text-white' :
                                              item.badge === 'ÏúÑÌóò' ? 'bg-red-600 text-white' :
                                              item.badge === 'Í∑πÌïú' ? 'bg-black text-red-500 border border-red-500' :
                                              item.badge === 'Ï§ëÏöî' ? 'bg-yellow-500 text-black' :
                                              item.badge === 'Ïù∏Í∏∞' ? 'bg-pink-500 text-white' :
                                              item.badge === '100+' ? 'bg-blue-600 text-white' :
                                              'bg-gray-700 text-gray-300'}
                                          `}>
                                            {item.badge}
                                          </span>
                                        )}
                                      </div>
                                    </motion.div>
                                  )}
                                </AnimatePresence>
                              </Link>
                            </motion.li>
                          )
                        })}
                      </motion.ul>
                    )}
                  </AnimatePresence>
                </motion.div>
              )
            })}
          </div>
        </nav>

        {/* User Info & Subscription */}
        <div className="p-4 border-t border-gray-800">
          <AnimatePresence>
            {(isOpen || isHovered) && (
              <motion.div
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                exit={{ opacity: 0 }}
                className="space-y-3"
              >
                {/* User Status */}
                <div className="flex items-center gap-3">
                  <div className="relative">
                    <div className={`w-10 h-10 rounded-full bg-gradient-to-br ${
                      currentUser.tier === 'Black' ? 'from-black to-gray-800 border-2 border-yellow-400' :
                      currentUser.tier === 'Diamond' ? 'from-cyan-400 to-blue-500' :
                      currentUser.tier === 'Platinum' ? 'from-gray-300 to-gray-500' :
                      currentUser.tier === 'Gold' ? 'from-yellow-400 to-yellow-600' :
                      currentUser.tier === 'Silver' ? 'from-gray-400 to-gray-600' :
                      'from-green-400 to-blue-500'
                    }`}>
                      <FaCrown className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white text-xs" />
                    </div>
                  </div>
                  <div className="flex-1">
                    <div className="flex items-center gap-2">
                      <p className="text-white text-sm font-medium">{currentUser.name}</p>
                      <span className="px-1.5 py-0.5 text-xs bg-red-500/20 text-red-400 rounded font-bold">
                        {currentUser.role}
                      </span>
                    </div>
                    <div className="flex items-center gap-2">
                      <p className={`text-xs font-bold ${
                        currentUser.tier === 'Black' ? 'text-yellow-400' :
                        currentUser.tier === 'Diamond' ? 'text-cyan-400' :
                        currentUser.tier === 'Platinum' ? 'text-gray-300' :
                        currentUser.tier === 'Gold' ? 'text-yellow-500' :
                        currentUser.tier === 'Silver' ? 'text-gray-400' :
                        'text-green-400'
                      }`}>
                        {currentUser.tier} {currentUser.tier === 'Black' ? '‚àû' : 'Plan'}
                      </p>
                      {currentUser.tier === 'Black' && (
                        <span className="text-xs text-yellow-400">Î¨¥Ï†úÌïú</span>
                      )}
                    </div>
                  </div>
                </div>
                
                {/* Role & Tier Info */}
                <div className="text-xs space-y-1 p-2 bg-gray-800/50 rounded-lg">
                  <div className="flex justify-between">
                    <span className="text-gray-500">Ï†ëÍ∑º Í∂åÌïú:</span>
                    <span className="text-gray-400">{currentUser.role} Î†àÎ≤®</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-500">Íµ¨ÎèÖ Îì±Í∏â:</span>
                    <span className="text-gray-400">{currentUser.tier}</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-gray-500">ÌôúÏÑ± Î©îÎâ¥:</span>
                    <span className="text-gray-400">300+ Í∏∞Îä•</span>
                  </div>
                </div>
                
                {/* Upgrade Button (Black Îì±Í∏âÏù¥ ÏïÑÎãå Í≤ΩÏö∞Îßå) */}
                {currentUser.tier !== 'Black' && (
                  <button className="w-full py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white text-sm font-bold rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all shadow-lg">
                    ‚ö° ÏóÖÍ∑∏Î†àÏù¥Îìú
                  </button>
                )}
              </motion.div>
            )}
          </AnimatePresence>
          
          {!isOpen && !isHovered && (
            <div className="relative">
              <div className={`w-10 h-10 rounded-full bg-gradient-to-br mx-auto ${
                currentUser.tier === 'Black' ? 'from-black to-gray-800 border-2 border-yellow-400' :
                currentUser.tier === 'Diamond' ? 'from-cyan-400 to-blue-500' :
                currentUser.tier === 'Platinum' ? 'from-gray-300 to-gray-500' :
                currentUser.tier === 'Gold' ? 'from-yellow-400 to-yellow-600' :
                currentUser.tier === 'Silver' ? 'from-gray-400 to-gray-600' :
                'from-green-400 to-blue-500'
              }`}>
                <FaCrown className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white text-xs" />
              </div>
            </div>
          )}
        </div>
      </motion.aside>

      {/* Mobile Overlay */}
      <AnimatePresence>
        {isOpen && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 0.5 }}
            exit={{ opacity: 0 }}
            onClick={toggleSidebar}
            className="lg:hidden fixed inset-0 bg-black z-30"
          />
        )}
      </AnimatePresence>
    </>
  )
}